
# お笑い劇場エントリーシステム 要件定義書【確定版】

## 1. システム概要

### 1.1 目的

お笑い劇場のライブエントリー業務をデジタル化し、公平性の確保と業務効率化を実現する（最小コストで最大効果）

### 1.2 対象ライブ

- **口火ライブ**: 毎月1日22:00エントリー開始、月10-15回開催、各回9-11組
- **二足のわらじライブ**: 毎月10日22:00エントリー開始、月4回開催、各回16-17組

## 2. 機能要件

### 2.1 エントリー機能（演者向け）

#### 2.1.1 一括エントリーフォーム

- **アクセス方法**: 専用URL
- **入力項目**:
    - エントリー数: 1つ or 2つ選択
    - 【名義1】
        - 名義名（必須）
        - 代表者名（必須）※個人特定用
        - 希望日程（第1〜第3希望まで）
    - 【名義2】※選択時のみ表示
        - 名義名（必須）
        - 代表者名（必須）
        - 希望日程（第1〜第3希望まで）
    - 連絡先メールアドレス（必須）※1つのみ
- **受付開始**: 毎月1日・10日の22:00:00ジャスト
- **事前アクセス**: 21:50からフォーム表示（入力可能、送信は22:00から）
- **受付終了**: 22:30自動締切

#### 2.1.2 エントリー完了画面

```
エントリー受付完了！

出演の可否は23:00頃に決定予定です。
下記で交番表をご確認ください。
→ [交番表ページへ]

※このページをブックマーク推奨
```

### 2.2 交番表ページ（結果確認）

#### 2.2.1 表示内容

- **口火ライブ交番表**
    - 各回の日付・時間
    - 出演者一覧（名義名）
- **二足のわらじライブ交番表**
    - 各回の日付・時間
    - 出演者一覧（名義名）

#### 2.2.2 更新タイミング

- エントリー締切から約1時間後（23:00頃）
- スタッフが確定ボタンを押したタイミング

### 2.3 自動振り分け機能

#### 2.3.1 振り分けアルゴリズム

1. **基本方針**: 受付時刻順での先着優先
2. **制約条件**:
    - 同一名義：月1回まで
    - 同一個人：月2回まで（代表者名で判定）
    - 各回の組数：口火9-11組、二足のわらじ16-17組
3. **振り分け手順**:
    - エントリー時刻順でソート
    - 1つ目の名義から第1希望で配置試行
    - 成功したら2つ目の名義で配置試行
    - 制約違反の場合は第2、第3希望で再試行
    - 全希望で配置不可の場合は補欠リストに追加

### 2.4 管理機能（スタッフ向け）

#### 2.4.1 エントリー監視

- エントリー状況一覧（リアルタイム）
- 現在の受付件数表示

#### 2.4.2 振り分け結果管理

- 自動振り分け結果の確認画面
- 手動調整機能（最小限の組み替え）
- 交番表確定ボタン

## 3. 非機能要件

### 3.1 性能要件

- **同時アクセス**: 1,000ユーザー対応
- **レスポンス時間**: エントリー送信5秒以内

### 3.2 セキュリティ要件

- **基本対策**: SSL/TLS、基本的なレート制限
- **不正防止**: メールアドレス重複チェック

### 3.3 ユーザビリティ要件

- **スマホ最適化**: レスポンシブデザイン必須
- **直感的操作**: 3タップ以内でエントリー完了

## 4. システム構成

### 4.1 技術スタック

- **フロントエンド**: Next.js 14 + TypeScript
- **バックエンド**: Next.js API Routes
- **データベース**: PostgreSQL（Vercel提供無料枠）
- **インフラ**: Vercel
- **スタイリング**: Tailwind CSS

### 4.2 URL構成

- `/` - エントリーフォーム
- `/schedule` - 交番表ページ
- `/admin` - スタッフ管理画面

## 5. 月間運用コスト

- **Vercel**: 無料枠（ピーク時のみPro $20/月）
- **ドメイン**: $1/月
- **合計**: 平常時$1/月、ピーク時$21/月

## 6. 運用フロー

### 6.1 月次運用

1. **21:50** - エントリーフォーム入力開始可能
2. **22:00** - エントリー受付開始
3. **22:30** - エントリー自動締切
4. **22:30-23:00** - 自動振り分け + スタッフ確認・調整
5. **23:00頃** - 交番表公開

### 6.2 日常運用

- 交番表は常時閲覧可能
- スタッフは管理画面で状況確認